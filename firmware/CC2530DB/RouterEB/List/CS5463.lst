###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.30.1.41636 for 8051             15/Oct/2015  21:15:45 #
# Copyright 2004-2013 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#                                                                             #
#    Source file        =  C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\Source\CS5463.c                                 #
#    Command line       =  -f C:\Users\paolo\Documents\GitHub\zpowermeter\fir #
#                          mware\CC2530DB\..\Tools\f8wRouter.cfg (-DCPU32MHZ  #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8       #
#                          -DMAC_CFG_RX_MAX=5 -DRTR_NWK) -f                   #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Tools\f8wConfig.cfg (-DZIGBEEPRO    #
#                          -DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR       #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=5000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100    #
#                          -DREJOIN_POLL_RATE=440) -f                         #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Tools\f8wZCL.cfg                    #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\Source\CS5463.c -D SECURE=0 -D                  #
#                          OSC32K_CRYSTAL_INSTALLED=FALSE -D HAL_KEY=FALSE    #
#                          -D HAL_BOARD_CC2530EB_REV17 -D TC_LINKKEY_JOIN -D  #
#                          NV_INIT -D xNV_RESTORE -D MULTICAST_ENABLED=FALSE  #
#                          -D ZCL_READ -D ZCL_WRITE -D ZCL_REPORT -D          #
#                          FEATURE_SYSTEM_STATS -lC                           #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\RouterEB\List\ -lA                     #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\RouterEB\List\ --diag_suppress         #
#                          Pe001,Pa010 -o C:\Users\paolo\Documents\GitHub\zpo #
#                          wermeter\firmware\CC2530DB\RouterEB\Obj\ -e        #
#                          --debug --core=plain --dptr=16,1                   #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I C:\Users\paolo\Documents\GitHub\zpowermeter\fir #
#                          mware\CC2530DB\ -I C:\Users\paolo\Documents\GitHub #
#                          \zpowermeter\firmware\CC2530DB\..\Source\ -I       #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Source\ha\ -I                       #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Source\zmain\ -I                    #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\hal\include\ -I          #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\hal\target\CC2530EB\ -I  #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\mac\include\ -I          #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\mac\high_level\ -I       #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\mac\low_level\srf04\ -I  #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\mac\low_level\srf04\sing #
#                          le_chip\ -I C:\Users\paolo\Documents\GitHub\zpower #
#                          meter\firmware\CC2530DB\..\Components\mt\ -I       #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\osal\include\ -I         #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\services\saddr\ -I       #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\services\sdata\ -I       #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\stack\af\ -I             #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\stack\nwk\ -I            #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\stack\sapi\ -I           #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\stack\sec\ -I            #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\stack\sys\ -I            #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\stack\zcl\ -I            #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\stack\zdo\ -I            #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\zmac\ -I                 #
#                          C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\..\Components\zmac\f8w\ -Ohz           #
#                          --require_prototypes                               #
#    List file          =  C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\RouterEB\List\CS5463.lst               #
#    Object file        =  C:\Users\paolo\Documents\GitHub\zpowermeter\firmwa #
#                          re\CC2530DB\RouterEB\Obj\CS5463.r51                #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\paolo\Documents\GitHub\zpowermeter\firmware\Source\CS5463.c
      1          /**************************************************************************************************
      2          
      3           DESCRIPTION:
      4            --
      5          
      6           CREATED: 14/10/2015, by Paolo Achdjian
      7          
      8           FILE: CS2530.c
      9          
     10          ***************************************************************************************************/
     11          #include "ZComDef.h"
     12          #include "OSAL.h"
     13          #include "ioCC2530.h"

   \                                 In  segment SFR_AN, at 0x80
   \   union <unnamed> volatile __sfr _A_P0
   \                     _A_P0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xc1
   \   unsigned char volatile __sfr U0DBUF
   \                     U0DBUF:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xc2
   \   unsigned char volatile __sfr U0BAUD
   \                     U0BAUD:
   \   000000                DS 1
     14          #include "CS5463.h"
     15          
     16          // U0GCR
     17          __sfr __no_init volatile struct  {
     18          	unsigned char U0_CPOL: 1;
     19          	unsigned char U0_CPHA: 1;
     20          	unsigned char U0_ORDER: 1;
     21          	unsigned char U0_BAUD_E: 5;

   \                                 In  segment SFR_AN, at 0xc5
     22          } @ 0xC5;
   \                     _A_U0_CPOL:
   \   000000                DS 1
     23          
     24          // U0CSR
     25          __sfr __no_init volatile struct  {
     26          	unsigned char U0_MODE: 1;
     27          	unsigned char U0_RE: 1;
     28          	unsigned char U0_SLAVE: 1;
     29          	unsigned char U0_FE: 1;
     30          	unsigned char U0_ERR: 1;
     31          	unsigned char U0_RX_BYTE: 1;
     32          	unsigned char U0_TX_BYTE: 1;
     33          	unsigned char U0_ACTIVE: 1;

   \                                 In  segment SFR_AN, at 0x86
     34          } @ 0x86;
   \                     _A_U0_MODE:
   \   000000                DS 1
     35          
     36          __sfr __no_init volatile struct  {
     37          	unsigned char DIR0_7: 1;
     38          	unsigned char DIR0_6: 1;
     39          	unsigned char DIR0_5: 1;
     40          	unsigned char DIR0_4: 1;
     41          	unsigned char DIR0_3: 1;
     42          	unsigned char DIR0_2: 1;
     43          	unsigned char DIR0_1: 1;
     44          	unsigned char DIR0_0: 1;

   \                                 In  segment SFR_AN, at 0xfd
     45          } @ 0xFD;
   \                     _A_DIR0_7:
   \   000000                DS 1
     46          
     47          __sfr __no_init volatile struct  {
     48          	unsigned char P0SEL_7: 1;
     49          	unsigned char P0SEL_6: 1;
     50          	unsigned char P0SEL_5: 1;
     51          	unsigned char P0SEL_4: 1;
     52          	unsigned char P0SEL_3: 1;
     53          	unsigned char P0SEL_2: 1;
     54          	unsigned char P0SEL_1: 1;
     55          	unsigned char P0SEL_0: 1;

   \                                 In  segment SFR_AN, at 0xf3
     56          } @ 0xF3;
   \                     _A_P0SEL_7:
   \   000000                DS 1
     57          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     58          void CS5463_Init(void ){
   \                     CS5463_Init:
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
     59          	U0_ACTIVE=0;
   \   000004   53867F       ANL     0x86,#0x7f
     60          	U0BAUD=0;
   \   000007   75C200       MOV     0xc2,#0x0
     61          	U0_BAUD_E=15;
   \   00000A   E5C5         MOV     A,0xc5
   \   00000C   5407         ANL     A,#0x7
   \   00000E   4478         ORL     A,#0x78
   \   000010   F5C5         MOV     0xc5,A
     62          	U0_CPOL=0;
   \   000012   53C5FE       ANL     0xc5,#0xfe
     63          	U0_CPHA=0;
   \   000015   53C5FD       ANL     0xc5,#0xfd
     64          	U0_ORDER=1;
   \   000018   43C504       ORL     0xc5,#0x4
     65          	
     66          	U0_MODE=0;
   \   00001B   5386FE       ANL     0x86,#0xfe
     67          	U0_SLAVE=0;
   \   00001E   5386FB       ANL     0x86,#0xfb
     68          	
     69          	P0SEL_2=1;
   \   000021   43F320       ORL     0xf3,#0x20
     70          	P0SEL_3=1;
   \   000024   43F310       ORL     0xf3,#0x10
     71          	P0SEL_5=1;
   \   000027   43F304       ORL     0xf3,#0x4
     72          	
     73          	DIR0_7 = 1;
   \   00002A   43FD01       ORL     0xfd,#0x1
     74          	P0SEL_7 = 0;
   \   00002D   53F3FE       ANL     0xf3,#0xfe
     75          	P0_7=1;
   \   000030   D287         SETB    0x80.7
     76          	
     77          	CS5463_startConversion();
   \   000032                ; Setup parameters for call to function CS5463_startConversion
   \   000032   12....       LCALL   ??CS5463_startConversion?relay; Banked call to: CS5463_startConversion
     78          }
   \   000035   D083         POP     DPH
   \   000037   D082         POP     DPL
   \   000039   02....       LJMP    ?BRET
   \   00003C                REQUIRE _A_U0_MODE
   \   00003C                REQUIRE U0BAUD
   \   00003C                REQUIRE _A_U0_CPOL
   \   00003C                REQUIRE _A_P0SEL_7
   \   00003C                REQUIRE _A_DIR0_7
   \   00003C                REQUIRE _A_P0
     79          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     80          void CS5463_startConversion(void) {
   \                     CS5463_startConversion:
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
     81          	P0_7=0;
   \   000000   C287         CLR     0x80.7
     82          	asm("NOP");
   \   000002   00           NOP
     83          	asm("NOP");
   \   000003   00           NOP
     84          	U0DBUF=0xE8;
   \   000004   75C1E8       MOV     0xc1,#-0x18
     85          	while(U0_TX_BYTE==0);
   \                     ??CS5463_startConversion_0:
   \   000007   E586         MOV     A,0x86
   \   000009   A2E6         MOV     C,0xE0 /* A   */.6
   \   00000B   50FA         JNC     ??CS5463_startConversion_0
     86          	asm("NOP");
   \   00000D   00           NOP
     87          	asm("NOP");
   \   00000E   00           NOP
     88          	P0_7=1;
   \   00000F   D287         SETB    0x80.7
     89          }
   \   000011   02....       LJMP    ?BRET
   \   000014                REQUIRE _A_P0
   \   000014                REQUIRE U0DBUF
   \   000014                REQUIRE _A_U0_MODE

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??CS5463_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    CS5463_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??CS5463_startConversion?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    CS5463_startConversion
     90          

   Maximum stack usage in bytes:

   ISTACK Function
   ------ --------
      2   CS5463_Init
        2   -> CS5463_startConversion
      0   CS5463_startConversion


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
       6  ??CS5463_Init?relay
       6  ??CS5463_startConversion?relay
      60  CS5463_Init
      20  CS5463_startConversion
       1  U0BAUD
       1  U0DBUF
       1  _A_DIR0_7
       1  _A_P0
       1  _A_P0SEL_7
       1  _A_U0_CPOL
       1  _A_U0_MODE

 
 80 bytes in segment BANKED_CODE
 12 bytes in segment BANK_RELAYS
  7 bytes in segment SFR_AN
 
 92 bytes of CODE memory
  0 bytes of DATA memory (+ 7 bytes shared)

Errors: none
Warnings: none
